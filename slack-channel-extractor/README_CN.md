# Slack 频道消息提取器

**[English](README.md)** | **[中文](README_CN.md)**

Chrome 浏览器扩展，用于从 Slack 频道提取消息，模拟人类行为以进行数据分析。

## 功能特性

- 类人滚动行为避免检测
- 提取消息、会话串、表情反应和附件
- 可配置的自动保存间隔
- 导出为 JSON 或 CSV 格式
- 分析就绪的会话串组织
- 进度跟踪和活动日志

## 安装步骤

### 1. 生成图标文件

首先，创建必需的图标文件。你可以：

**方案 A**：使用包含的脚本生成简单图标：
```bash
cd slack-channel-extractor
python3 generate_icons.py
```

**方案 B**：创建你自己的 PNG 图标：
- `icons/icon16.png` (16x16 像素)
- `icons/icon48.png` (48x48 像素)
- `icons/icon128.png` (128x128 像素)

### 2. 在 Chrome 中加载扩展

1. 打开 Chrome 并访问 `chrome://extensions/`
2. 启用**开发者模式**（右上角的开关）
3. 点击**加载已解压的扩展程序**
4. 选择 `slack-channel-extractor` 文件夹
5. 扩展图标应该出现在工具栏中

## 使用方法

### 步骤 1：导航到 Slack

1. 在 Chrome 中打开 [app.slack.com](https://app.slack.com)
2. 登录到你的工作区
3. 导航到你想要提取的频道

### 步骤 2：配置设置

点击扩展图标打开控制面板：

- **滚动延迟**：滚动之间的时间间隔（2-8 秒）。数值越高越像人类，但速度越慢。
- **包含会话串回复**：是否跟踪会话串元数据
- **自动保存间隔**：每 N 条消息保存一次数据

### 步骤 3：开始提取

1. 点击**开始提取**
2. 扩展将会：
   - 自动向上滚动浏览频道
   - 提取可见的消息
   - 偶尔暂停以模拟阅读
   - 按配置的间隔自动保存
3. 你可以随时**暂停**、**恢复**或**停止**

### 步骤 4：导出数据

提取完成后（或任何时候）：

- **导出 JSON**：包含元数据的完整数据
- **导出 CSV**：电子表格兼容格式

## 输出格式

### JSON 导出
```json
{
  "exported_at": "2024-01-15T10:30:00.000Z",
  "total_messages": 5000,
  "messages": [
    {
      "ts": "1705234567.123456",
      "user_id": "U12345678",
      "user_name": "john.doe",
      "text": "大家好！",
      "thread_ts": null,
      "reply_count": 3,
      "reactions": [{"emoji": ":thumbsup:", "count": 5}],
      "attachments": [],
      "extracted_at": "2024-01-15T10:25:00.000Z"
    }
  ]
}
```

### CSV 导出
```csv
timestamp,datetime,user_id,user_name,text,thread_ts,reply_count,reactions,attachments
1705234567.123456,2024-01-14T12:34:27.123Z,U12345678,john.doe,"大家好！",,3,"[{""emoji"":"":thumbsup:"",""count"":5}]",[]
```

## 反检测特性

该扩展采用多种策略避免被 Slack 的安全检测系统发现：

1. **类人滚动**
   - 随机滚动距离（200-500px）
   - 可变延迟加随机化
   - 偶尔的较长"阅读"暂停

2. **真实浏览器环境**
   - 使用你实际的登录会话
   - 保留完整的浏览器指纹
   - 无可疑的 API 调用模式

3. **自然行为**
   - 用户触发（非自动化）
   - 可见操作（你能看到滚动过程）
   - 遵守页面加载时间

## 最佳实践

### 针对大型频道（10,000+ 消息）

1. **使用较长延迟**：将滚动延迟设置为 5-8 秒
2. **定期休息**：周期性暂停提取
3. **分段会话**：不要一次性提取所有内容
4. **频繁保存**：使用较小的自动保存间隔（50 条消息）

### 建议

- 最佳时间：在频道不活跃的非高峰时段
- 保持 Chrome 标签可见（不要最小化）
- 不要同时使用多个 Slack 标签
- 如果提取似乎卡住，尝试刷新页面

## 故障排除

### 扩展无法工作

1. 确保你在 `app.slack.com`（不是桌面应用）
2. 刷新 Slack 页面
3. 检查扩展是否在 `chrome://extensions/` 中启用

### 消息缺失

1. 某些消息可能在折叠的会话串中
2. 非常旧的消息可能需要更多滚动
3. 检查是否已到达频道开头

### 提取意外停止

1. 页面可能已滚动到顶部
2. 网络问题 - 刷新并恢复
3. 检查 Chrome 控制台的错误信息

## 数据分析技巧

导出的数据可直接用于分析。常见用例：

### 意图分类
```python
import json

with open('slack_messages.json') as f:
    data = json.load(f)

# 按会话串分组消息以进行对话分析
threads = {}
for msg in data['messages']:
    thread_ts = msg.get('thread_ts') or msg['ts']
    if thread_ts not in threads:
        threads[thread_ts] = []
    threads[thread_ts].append(msg)
```

### 用户活跃度分析
```python
from collections import Counter

user_counts = Counter(msg['user_name'] for msg in data['messages'] if msg.get('user_name'))
print("最活跃用户：", user_counts.most_common(10))
```

## 隐私与安全

### 🔒 数据隐私保证

- **所有数据都在本地**：消息仅存储在你的浏览器本地存储中（Chrome 的 `chrome.storage.local`）
- **零外部通信**：此扩展不会向外部服务器或第三方发送任何数据
- **无需凭据**：使用你现有的 Slack 浏览器会话 - 不存储密码、令牌或 API 密钥
- **无跟踪或分析**：没有遥测、使用统计或用户行为跟踪
- **完全用户控制**：你决定提取什么、何时导出以及在哪里存储数据

### 🛡️ 安全最佳实践

1. **仅在受信任的设备上使用**：只在你信任和控制的计算机上使用此扩展
2. **安全存储**：导出的文件可能包含敏感对话 - 请安全存储
3. **使用后清理**：如果导出的数据包含敏感信息，分析后请删除
4. **组织政策**：了解并遵守你的组织的数据导出和保留政策
5. **分享前审查**：在分享之前始终审查导出的文件，确保不包含敏感信息

### 🔐 安全特性

- **仅本地处理**：所有消息提取和处理都在你的浏览器中进行
- **不滥用 API**：不使用 Slack 的 API（这需要令牌）
- **基于会话**：通过标准 DOM 访问利用你已验证的浏览器会话
- **开源**：所有代码都公开可供安全审查
- **无外部依赖**：没有可能引入漏洞的第三方库

### ⚠️ 重要说明

- 此工具设计用于合法的数据分析和存档目的
- 尊重隐私：仅提取你有合法访问权限的频道数据
- 遵守法律：确保你的使用符合适用的数据保护法规（GDPR、CCPA 等）
- 工作区政策：使用前请查看你的 Slack 工作区的数据导出政策

### 🐛 报告安全问题

如果你发现安全漏洞，请负责任地报告：

1. **不要**为安全漏洞打开公开的 GitHub issue
2. 通过以下方式报告安全问题：[创建 GitHub 安全公告](https://github.com/stone16/slack-extractor-chrome-extension/security/advisories/new)
3. 包含重现问题的详细步骤
4. 在公开披露之前给予合理的修复时间

我们非常重视安全性，并会及时回应合法的安全问题。

## 限制

- 无法提取你没有访问权限的私有频道
- 无法从公共频道提取直接消息
- 不下载文件内容（仅元数据）
- 速率取决于 Slack 的页面加载行为

## 许可证

MIT License - 随意修改和分发。

---

## 常见问题 (FAQ)

### 这个工具合法吗？

是的，此工具仅访问你已有权限查看的数据。它不绕过任何访问控制或认证机制。但是，你应该：
- 遵守你的组织的数据使用政策
- 遵守适用的数据保护法律
- 仅用于合法和道德的目的

### 会被 Slack 检测到吗？

该工具模拟人类滚动行为以降低检测风险。但是：
- 没有绝对的保证
- 使用合理的滚动延迟（建议 3-5 秒）
- 避免在短时间内大量提取
- 最好在非高峰时段使用

### 数据存储在哪里？

所有数据都存储在你的浏览器的本地存储中（`chrome.storage.local`）。这意味着：
- 数据永远不会离开你的计算机
- 卸载扩展会删除存储的数据
- 导出的文件保存在你选择的位置

### 可以提取私有频道吗？

可以，但仅限于你已有访问权限的私有频道。此工具使用你现有的 Slack 会话，因此只能访问你通常可以查看的内容。

### 如何删除提取的数据？

1. 在扩展弹出窗口中点击"清除缓存数据"
2. 或者卸载扩展
3. 手动删除你导出的 JSON/CSV 文件

### 支持哪些浏览器？

目前仅支持 Google Chrome 和基于 Chromium 的浏览器（如 Edge、Brave）。不支持 Firefox、Safari。

### 可以同时提取多个频道吗？

不建议。为了降低检测风险，一次只提取一个频道。完成一个频道后再开始下一个。

---

## 贡献

欢迎贡献！请随时提交 Pull Request 或开启 Issue。

### 开发设置

```bash
# 克隆仓库
git clone https://github.com/stone16/slack-extractor-chrome-extension.git
cd slack-extractor-chrome-extension/slack-channel-extractor

# 生成图标
python3 generate_icons.py

# 在 Chrome 中加载扩展进行测试
# chrome://extensions/ -> 开发者模式 -> 加载已解压的扩展程序
```

### 代码风格

- 使用清晰、描述性的变量名
- 为复杂逻辑添加注释
- 遵循现有的代码结构

---

## 致谢

感谢所有贡献者和使用此工具进行数据分析的用户。

---

## 免责声明

此工具仅供教育和合法数据分析目的。用户有责任确保其使用符合所有适用的法律、法规和政策。作者不对此工具的误用或滥用负责。
